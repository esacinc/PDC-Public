<div class="browse-page-wrapper" style="overflow-x: hidden;">
<div class="flex min-h-[1100px] pl-[5px] w-full" style="overflow-x: hidden;">
  <!-- Sidebar -->
  <aside class="flex-shrink-0" [style.display]="opened ? 'block' : 'none'">
    <div class="">
      <!-- Optional header content here -->
      <!--
      <img width="20" height="20" src="./assets/css/images/Triangle.png" alt="Triangle" />
      <span class="mx-2 font-semibold">FILTERS</span>
      <button class="ml-auto p-0" aria-label="Hide filters">
        <i class="fa fa-angle-double-left"></i>
      </button>
      -->
    </div>
    <browse-filters
      [breadCrumbFilters]="filtersChangedInBreadcrumbBar"
      (selectedFilesDataCategoryFilters)="onFilesFiltersSelected($event)"
      (selectedFilters)="onFilterSelected($event)"
      [parentCharts]="parentCharts"
      [selectedTab]="selectedTab"
      (selectedTabForStudySummary)="selectedTabChange($event)"
    >
      Starting filters...
    </browse-filters>
    <button
      class="mt-2 p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50"
    
      (click)="toggleSidenav()"
      [disabled]="disablePanelsFlag"
      aria-label="Hide filters"
    >
      <i class="fa fa-angle-double-left"></i>
      <span class="sr-only">Hide filters</span>
    </button>
  </aside>
  <div class="mt-[3px] flex-1 min-w-0" style="overflow-x: hidden;">
  <!-- Toggle buttons -->
  <button
    *ngIf="opened"
    class="p-0 pl-3 pr-2 pt-0 text-gray-600 hover:text-gray-900"
    (click)="toggleSidenav()"
    id="hideFiltersOptionTop"
    aria-label="Hide filters"
  >
    <i class="fa fa-angle-double-left"></i>
    <span class="sr-only">Hide filters</span>
  </button>
  <button
    *ngIf="!opened && !disablePanelsFlag"
    class="p-0 pl-3 pr-2 pt-0 text-gray-600 hover:text-gray-900"
    (click)="toggleSidenav()"
    id="showFilters"
    aria-label="Show filters"
  >
    <i class="fa fa-angle-double-right"></i>
    <span class="sr-only">Show filters</span>
  </button>

  <!-- Breadcrumbs -->
  
  <span
    *ngIf="breadcrumbs.length == 0"
    class="text-[15px] font-bold ml-[-10px]"
  >
       Start searching by selecting a facet
  </span>
  <div
    *ngIf="breadcrumbs.length > 0"
    class="pl-[13px] pr-[15px] pb-[10px]"
  >
    <button
      *ngIf="breadcrumbs.length > 0 && !disablePanelsFlag"
      class="btn btn-primary breadCrumbButtons"
      (click)="clearAllSelections()"
    >
      CLEAR
    </button>
    &nbsp;
    <span *ngFor="let crumb of breadcrumbs; index as i">
      <button
        class="btn btn-primary breadCrumbButtons bg-black"
        (click)="deleteBreadcrumb(crumb)"
        [disabled]="disablePanelsFlag"
      >
        {{ crumb.value }}&nbsp;&nbsp;&nbsp;
        <i
          class="fa fa-close text-xs"
          *ngIf="!disablePanelsFlag"
        ></i>
      </button>
      &nbsp;
      <button class="btn btn-primary breadCrumbButtons" disabled>
        {{ crumb.separator }}
      </button>
      &nbsp;
      <span *ngIf="crumb.separator === 'IN'">( &nbsp; </span>
      <span *ngFor="let facetValue of crumb.facetValues">
        <button
          class="btn btn-primary breadCrumbButtons bg-gray-500"
          (click)="deleteBreadcrumbVal(facetValue)"
          [disabled]="disablePanelsFlag"
        >
          {{ facetValue.value }}&nbsp;&nbsp;&nbsp;
          <i
            class="fa fa-close text-xs"
            *ngIf="!disablePanelsFlag"
          ></i>
        </button>
        &nbsp;
      </span>
      <span *ngIf="crumb.separator === 'IN'">) </span>
      <button
        *ngIf="breadcrumbs.length > 1 && i < breadcrumbs.length - 1"
        class="btn btn-primary breadCrumbButtons"
        disabled
      >
        AND
      </button>
      &nbsp;
    </span>
    <br />
    <button
      class="btn btn-primary mt-2"
      (click)="showBookmarkToggle()"
      *ngIf="!disablePanelsFlag"
    >
      {{ showBookmarkFlag == false ? 'Show Query URL' : 'Hide Query URL' }}
    </button>
    <div *ngIf="showBookmarkFlag">
      <a [href]="bookmarkURL">{{ bookmarkURL }}</a>
      <button
        class="ml-2 p-2"
        id="copyURLQuery2Clipboard"
        (click)="copyTextToClipboard(bookmarkURL)"
        aria-label="Copy to Clipboard"
      >
        <i class="fa fa-clipboard"></i>
        <span class="sr-only">Copy to Clipboard</span>
      </button>
    </div>
  </div>


  <!-- Expansion Panel (Charts) -->
   <div class="browsePageExpansionPanel" style="margin: 0 10px 0 10px; max-width: calc(100% - 20px); overflow-x: hidden;" *ngIf="!disablePanelsFlag">
        <mat-expansion-panel [expanded]="true">
            <mat-expansion-panel-header>
                <mat-panel-title>Charts</mat-panel-title>
              </mat-expansion-panel-header>
           <mat-card class="browse-page card charts-card" style="margin: 0; padding: 10px; max-width: 100%; overflow-x: hidden;">
              <div style="display: flex; flex-wrap: wrap; gap: 10px; max-width: 100%;">
                <div style="flex: 1; min-width: 300px; max-width: calc(33.333% - 10px); padding: 10px; box-sizing: border-box;">
                    <div class="text-center font-semibold py-2">ANALYTICAL FRACTIONS</div>
                    <div id="analyticalFractionChart" style="width: 100%; height: 360px; max-width: 100%; overflow: hidden; box-sizing: border-box;"></div>
                </div>
                <div style="flex: 1; min-width: 300px; max-width: calc(33.333% - 10px); padding: 10px; box-sizing: border-box;">
                    <div class="text-center font-semibold py-2">DISEASE TYPES</div>
                    <div id="diseaseTypesChart" style="width: 100%; height: 360px; max-width: 100%; overflow: hidden; box-sizing: border-box;"></div>
                </div>
                <div style="flex: 1; min-width: 300px; max-width: calc(33.333% - 10px); padding: 10px; box-sizing: border-box;">
                    <div class="text-center font-semibold py-2">EXPERIMENT TYPES</div>
                    <div id="expCountChart" style="width: 100%; height: 360px; max-width: 100%; overflow: hidden; box-sizing: border-box;"></div>
                </div>
              </div>
            </mat-card>
          </mat-expansion-panel>
      </div>
 <!--
  <div
    class="browsePageExpansionPanel pl-[10px] pr-[15px] w-full"
    [@expandCollapse]="expandCollapseState"
    *ngIf="!disablePanelsFlag"
  >
    <div class="mb-4  w-full">
      <div class="">
        <div class="flex flex-wrap -mx-2">
          <div class="w-full md:w-1/3 px-2 mb-4">
            <div class="border rounded mb-2 flex flex-col" style="height: 420px;">
              <div class="text-center font-semibold py-2 border-b">ANALYTICAL FRACTIONS</div>
              <div class="flex-1 p-2 overflow-hidden">
                <div id="analyticalFractionChart" style="width: 100%; height: 100%;"></div>
              </div>
            </div>
          </div>
          <div class="w-full md:w-1/3 px-2 mb-4" >
            <div class="border rounded mb-2 flex flex-col" style="height: 420px;">
              <div class="text-center font-semibold py-2 border-b">DISEASE TYPES</div>
              <div class="flex-1 p-2 overflow-hidden">
                <div id="diseaseTypesChart" style="width: 100%; height: 100%;"></div>
              </div>
            </div>
          </div>
          <div class="w-full md:w-1/3 px-2 mb-4">
            <div class="border rounded mb-2 flex flex-col" style="height: 420px;">
              <div class="text-center font-semibold py-2 border-b">EXPERIMENT TYPES</div>
              <div class="flex-1 p-2 overflow-hidden">
                <div id="expCountChart" style="width: 100%; height: 100%;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
-->

  <!-- Spinner -->
  <div
    class="ml-[10px] mt-[10px] flex items-center"
    *ngIf="controlFileDownloadSpinner == true"
  >
    <i class="fa fa-spinner fa-spin text-2xl"></i>
    &nbsp;&nbsp;&nbsp;File Download in progress. Please wait...
  </div>

  <!-- Tabs (replace mat-tab-group/mat-tab with your own tab logic or a Tailwind-compatible tab component) -->
  <!-- Example placeholder: -->
  <!-- Tailwind-based tab group -->
<div class="table-panels pl-[10px] pt-[10px] overflow-x-hidden">
  <!-- Tab headers -->
 
    <div class="flex border-b mb-4 justify-between items-center">
    <div class="flex gap-1">
      <button
        class="outline outline-1 outline-gray-300 px-6 py-3 -mb-px border-b-2 min-w-[140px]"
        [ngClass]="selectedTab === 0 ? 'border-blue-500 bg-[#D4E7F2]  text-blue-600 font-semibold' : 'border-transparent text-gray-600'"
        (click)="selectedTab = 0"
        *ngIf="!disablePanelsFlag"
      >
        Studies ({{ studyTotalRecords }})
      </button>
      <button
        class="outline outline-1 outline-gray-300 px-6 py-3 -mb-px border-b-2 min-w-[140px]"
        [ngClass]="selectedTab === 1 ? 'border-blue-500 bg-[#D4E7F2] text-blue-600 font-semibold' : 'border-transparent text-gray-600'"
        (click)="selectedTab = 1"
        *ngIf="!disablePanelsFlag"
        
      >
        Biospecimens ({{ biospecimenTotalRecords }})
      </button>
      <button
        class="outline outline-1 outline-gray-300 px-6 py-3 -mb-px border-b-2 min-w-[140px]"
        [ngClass]="selectedTab === 2 ? 'border-blue-500 bg-[#D4E7F2] text-blue-600 font-semibold' : 'border-transparent text-gray-600'"
        (click)="selectedTab = 2"
        *ngIf="!disablePanelsFlag"
      >
        Clinical ({{ clinicalTotalRecords }})
      </button>
      <button
        class="outline outline-1 outline-gray-300 px-6 py-3 -mb-px border-b-2 min-w-[140px]"
        [ngClass]="selectedTab === 3 ? 'border-blue-500 bg-[#D4E7F2]  text-blue-600 font-semibold' : 'border-transparent text-gray-600'"
        (click)="selectedTab = 3"
      >
       Files ({{ fileTotalRecords }})
      </button>
      <button
        class="outline outline-1 outline-gray-300 px-6 py-3 -mb-px border-b-2 min-w-[140px]"
        [ngClass]="selectedTab === 4 ? 'border-blue-500 bg-[#D4E7F2] text-blue-600 font-semibold' : 'border-transparent text-gray-600'"
        (click)="selectedTab = 4"
        *ngIf="!disablePanelsFlag"
      >
        Genes ({{ genesTotalRecords }})
      </button>
    </div>
    </div>
  </div>

  <!-- Tab panels -->

  <div [style.display]="selectedTab === 0 && !disablePanelsFlag ? 'block' : 'none'" class="pl-0 ml-[15px] mb-[75px] mr-[10px]">
    <browse-by-study
      (isTableLoading)="handleTabLoading($event)"
      [handleTableLoading]="handleTableLoading"
      [enableDownloadAllManifests]="enableDownloadAllManifests"
      [newFilterValue]="newFilterValue"
      (studyTotalRecordChanged)="totalRecordChanged($event)"
      (selectedTabChangeForCaseCount)="changeTabForCaseCount($event)"
      (selectedTabChangeForFileType)="changeTabForFileType($event)"
      (downloadWholeManifestFlag)="downloadWholeManifest($event)"
      [downloadAllManifests]="downloadAllManifests"
      [childTabChanged]="captureTabChange"
    >Starting browse by study...</browse-by-study>
  </div>
  <div [style.display]="selectedTab === 1 && !disablePanelsFlag ? 'block' : 'none'" class="pl-0 ml-[15px] mb-[65px] mr-[10px]">
    <browse-by-case
      (isTableLoading)="handleTabLoading($event)"
      [handleTableLoading]="handleTableLoading"
      [enableDownloadAllManifests]="enableDownloadAllManifests"
      [newFilterValue]="newFilterValue"
      (biospecimenTotalRecordChanged)="totalRecordChanged($event)"
      (downloadWholeManifestFlag)="downloadWholeManifest($event)"
      [downloadAllManifests]="downloadAllManifests"
      [childTabChanged]="captureTabChange"
    >Starting browse by case...</browse-by-case>
  </div>
  <div [style.display]="selectedTab === 2 && !disablePanelsFlag ? 'block' : 'none'" class="pl-0 ml-[15px] mb-[65px] mr-[10px]">
    <browse-by-clinical
      (isTableLoading)="handleTabLoading($event)"
      [handleTableLoading]="handleTableLoading"
      [enableDownloadAllManifests]="enableDownloadAllManifests"
      [newFilterValue]="newFilterValue"
      (clinicalTotalRecordChanged)="totalRecordChanged($event)"
      (downloadWholeManifestFlag)="downloadWholeManifest($event)"
      [downloadAllManifests]="downloadAllManifests"
      [childTabChanged]="captureTabChange"
    >Starting browse by clinical data...</browse-by-clinical>
  </div>
  <div [style.display]="selectedTab === 3 ? 'block' : 'none'" class="pl-0 ml-[15px] mb-[65px] mr-[10px]">
    <browse-by-file
      (isFileTableLoading)="handleTabLoading($event)"
      [handleTableLoading]="handleTableLoading"
      [enableDownloadAllManifests]="enableDownloadAllManifests"
      [otherTabsLoaded]="otherTabsLoaded"
      [newFilesFilterValue]="newFilesFilterValue"
      [newFilterValue]="newFilterValue"
      (fileTotalRecordChanged)="totalRecordChanged($event)"
      (downloadWholeManifestFlag)="downloadWholeManifest($event)"
      [downloadAllManifests]="downloadAllManifests"
      (oldStudyVersion)="setOldStudyVersion($event)"
      [childTabChanged]="captureTabChange"
    >Starting browse by file...</browse-by-file>
  </div>
  <div [style.display]="selectedTab === 4 && !disablePanelsFlag ? 'block' : 'none'" class="pl-0 ml-[15px] mb-[65px] mr-[10px]">
    <browse-by-gene
      (isTableLoading)="handleTabLoading($event)"
      [handleTableLoading]="handleTableLoading"
      [enableDownloadAllManifests]="enableDownloadAllManifests"
      [newFilterValue]="newFilterValue"
      (genesTotalRecordChanged)="totalRecordChanged($event)"
      (downloadWholeManifest)="downloadWholeManifest($event)"
      [downloadAllManifests]="downloadAllManifests"
      [childTabChanged]="captureTabChange"
    >Starting browse by genes data...</browse-by-gene>
  </div>
</div>
  <!-- Main content goes here -->
</div>
</div>
